import{j as e}from"./index-596hYXym.js";import{r as t}from"./router-BRn4_cjy.js";import{c as a}from"./client-B_jBfuGE.js";import{h as s,V as l,x as i,d as n,aI as r,aJ as d,aK as c,aL as o}from"./ui-TmEHN81D.js";import"./vendor-DtuzQOD1.js";const x={fullName:"",email:"",mobile:"",paid:!1,wantsChildrenWork:!1,wantsMinistryTeam:!1,userId:""};function m(){const[r,d]=t.useState(null),[c,o]=t.useState(!0);t.useEffect(()=>{(async()=>{try{const e=await a.staff.listStaff();d(e)}catch(e){console.error("Failed to fetch staff:",e)}finally{o(!1)}})()},[]);const[m,y]=t.useState(!1),[N,w]=t.useState(x),v=async(e,t)=>{alert("Driver's license upload simulated. Feature requires file storage implementation.")},C=(null==r?void 0:r.staff)||[],k=t.useMemo(()=>({total:C.length,paid:C.filter(e=>e.paid).length,volunteers:C.filter(e=>!e.paid).length,compliant:C.filter(e=>{var t;return null==(t=e.compliance)?void 0:t.eligible}).length}),[C]);return e.jsxs("div",{className:"bg-gray-800/50 border border-gray-700 p-4 md:p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(s,{className:"h-5 w-5 text-white"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg md:text-xl font-bold text-white heading-font",children:"Staff & Volunteers"}),e.jsx("p",{className:"text-gray-400 text-xs md:text-sm",children:"Manage STAFF profiles, compliance, and training."})]})]}),e.jsxs("button",{onClick:()=>y(!0),className:"self-start md:self-auto bg-white text-black hover:bg-gray-200 px-3 py-2 md:px-4 md:py-2 font-semibold uppercase tracking-wide inline-flex items-center text-xs md:text-sm",children:[e.jsx(l,{className:"mr-2 h-4 w-4"}),"Add Staff"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4 mb-4",children:[e.jsx(p,{label:"Total",value:k.total}),e.jsx(p,{label:"Paid",value:k.paid}),e.jsx(p,{label:"Volunteers",value:k.volunteers}),e.jsx(p,{label:"Compliant",value:k.compliant})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-xs md:text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx(h,{children:"Full Name"}),e.jsx(h,{children:"Contact"}),e.jsx(h,{children:"Paid"}),e.jsx(h,{className:"hidden sm:table-cell",children:"Children"}),e.jsx(h,{className:"hidden sm:table-cell",children:"Ministry Team"}),e.jsx(h,{children:"Compliance"}),e.jsx(h,{children:"Actions"})]})}),e.jsxs("tbody",{children:[c&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-gray-400 p-3",children:"Loading..."})}),!c&&C.map(t=>e.jsxs("tr",{className:"border-b border-gray-800",children:[e.jsxs("td",{className:"px-2 py-3",children:[e.jsx("div",{className:"text-white font-semibold",children:t.fullName}),e.jsxs("div",{className:"text-gray-400 text-[11px] md:text-xs",children:["UserID: ",t.userId||"—"]})]}),e.jsxs("td",{className:"px-2 py-3",children:[e.jsx("div",{className:"text-gray-300",children:t.email||"—"}),e.jsx("div",{className:"text-gray-500 text-[11px] md:text-xs",children:t.mobile||"—"})]}),e.jsx("td",{className:"px-2 py-3",children:e.jsx(f,{checked:t.paid,onChange:async e=>{try{await a.staff.updateStaff({id:t.id,paid:e});const s=await a.staff.listStaff();d(s)}catch(s){console.error("Failed to update staff:",s)}}})}),e.jsx("td",{className:"px-2 py-3 hidden sm:table-cell",children:e.jsx(f,{checked:t.wantsChildrenWork,onChange:async e=>{try{await a.staff.updateStaff({id:t.id,wantsChildrenWork:e});const s=await a.staff.listStaff();d(s)}catch(s){console.error("Failed to update staff:",s)}}})}),e.jsx("td",{className:"px-2 py-3 hidden sm:table-cell",children:e.jsx(f,{checked:t.wantsMinistryTeam,onChange:async e=>{try{await a.staff.updateStaff({id:t.id,wantsMinistryTeam:e});const s=await a.staff.listStaff();d(s)}catch(s){console.error("Failed to update staff:",s)}}})}),e.jsx("td",{className:"px-2 py-3",children:e.jsx(j,{s:t,onUpdate:async e=>{try{await a.staff.updateStaff({id:t.id,...e});const s=await a.staff.listStaff();d(s)}catch(s){console.error("Failed to update staff:",s)}},onUploadDL:v})}),e.jsx("td",{className:"px-2 py-3",children:e.jsxs("div",{className:"flex flex-col gap-2 w-[160px]",children:[e.jsxs("button",{onClick:()=>(t.id,void alert("Forms sent (simulated). Staff will receive a notification/email to complete required documents.")),className:"text-white bg-blue-600 hover:bg-blue-700 px-2 py-1 inline-flex items-center justify-center gap-1 text-[11px] md:text-xs",children:[e.jsx(i,{className:"h-3 w-3"})," Send Forms"]}),e.jsx("button",{onClick:()=>{const e=prompt("Set/Update UserID (for training tracking):",t.userId||"");null!==e&&(async()=>{try{await a.staff.updateStaff({id:t.id,userId:e||null});const s=await a.staff.listStaff();d(s)}catch(s){console.error("Failed to update staff:",s)}})()},className:"text-white bg-gray-700 hover:bg-gray-600 px-2 py-1 text-[11px] md:text-xs",children:"Link User ID"})]})})]},t.id)),!c&&0===C.length&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-gray-400 p-3",children:"No staff yet."})})]})]})}),m&&e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-2 md:p-4",children:e.jsx("div",{className:"bg-gray-800 border border-gray-700 w-full max-w-xl max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-4 md:p-6",children:[e.jsx("h3",{className:"text-lg md:text-2xl font-bold text-white mb-4 heading-font",children:"Add Staff/Volunteer"}),e.jsxs("form",{onSubmit:e=>{e.preventDefault(),(async()=>{try{await a.staff.createStaff({fullName:N.fullName,email:N.email||void 0,mobile:N.mobile||void 0,paid:N.paid,wantsChildrenWork:N.wantsChildrenWork,wantsMinistryTeam:N.wantsMinistryTeam,userId:N.userId||void 0}),y(!1),w(x);const e=await a.staff.listStaff();d(e)}catch(e){console.error("Failed to create staff:",e)}})()},className:"space-y-3 md:space-y-4",children:[e.jsxs(b,{cols:2,children:[e.jsx(u,{label:"Full Name *",value:N.fullName,onChange:e=>w({...N,fullName:e}),required:!0}),e.jsx(u,{label:"User ID (optional)",value:N.userId,onChange:e=>w({...N,userId:e})})]}),e.jsxs(b,{cols:2,children:[e.jsx(u,{label:"Email",value:N.email,onChange:e=>w({...N,email:e})}),e.jsx(u,{label:"Mobile",value:N.mobile,onChange:e=>w({...N,mobile:e})})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(g,{label:"Paid Staff",checked:N.paid,onChange:e=>w({...N,paid:e})}),e.jsx(g,{label:"Wants to work with children",checked:N.wantsChildrenWork,onChange:e=>w({...N,wantsChildrenWork:e})}),e.jsx(g,{label:"Wants to join Ministry Team",checked:N.wantsMinistryTeam,onChange:e=>w({...N,wantsMinistryTeam:e})})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx("button",{type:"submit",className:"bg-white text-black hover:bg-gray-200 px-4 py-2 font-semibold uppercase tracking-wide text-sm",children:"Save"}),e.jsx("button",{type:"button",className:"border border-gray-600 text-white hover:bg-gray-700 px-4 py-2 font-semibold uppercase tracking-wide text-sm",onClick:()=>y(!1),children:"Cancel"})]})]}),e.jsxs("div",{className:"mt-6 bg-blue-500/10 text-blue-300 border border-blue-500/20 p-3 text-xs",children:[e.jsxs("p",{className:"mb-1 font-semibold inline-flex items-center gap-2",children:[e.jsx(n,{className:"h-4 w-4"})," Training Requirements"]}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"If working with children: valid Blue Card required."}),e.jsx("li",{children:'If on Ministry Team (laying hands on the sick): must complete the training course "Ministering at a Church Meeting".'}),e.jsx("li",{children:"All staff/volunteers: policy acknowledgement, background/police checks, and a copy of driver's license (front) on file."})]})]})]})})})]})}function p({label:t,value:a}){return e.jsxs("div",{className:"bg-gray-900/50 border border-gray-700 p-3 md:p-4 text-center",children:[e.jsx("div",{className:"text-[11px] md:text-xs text-gray-400",children:t}),e.jsx("div",{className:"text-lg md:text-2xl font-bold text-white heading-font",children:a})]})}function h({children:t,className:a}){return e.jsx("th",{className:`text-left text-gray-400 font-semibold py-2 px-2 ${a||""}`,children:t})}function f({checked:t,onChange:a}){return e.jsx("button",{onClick:()=>a(!t),className:"px-2 py-1 text-[11px] md:text-xs font-semibold "+(t?"bg-green-500/20 text-green-400":"bg-gray-700 text-gray-300"),children:t?"Yes":"No"})}function g({label:t,checked:a,onChange:s}){return e.jsxs("label",{className:"text-white text-xs md:text-sm inline-flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a,onChange:e=>s(e.target.checked)}),e.jsx("span",{children:t})]})}function u({label:t,value:a,onChange:s,required:l}){return e.jsxs("div",{children:[e.jsxs("label",{className:"block text-white font-semibold mb-1 text-xs md:text-sm",children:[t,l?" *":""]}),e.jsx("input",{value:a,onChange:e=>s(e.target.value),required:l,className:"w-full bg-gray-700 border border-gray-600 text-white px-3 py-2 text-xs md:text-sm"})]})}function b({cols:t,children:a}){return e.jsx("div",{className:`grid grid-cols-1 ${t>=2?"md:grid-cols-2":""} gap-2 md:gap-4`,children:a})}function j({s:t,onUpdate:a,onUploadDL:s}){const l=t.compliance;return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(y,{icon:e.jsx(r,{className:"h-3 w-3"}),label:"Blue Card",needed:!!(null==l?void 0:l.requiresBlueCard),ok:!!(null==l?void 0:l.hasBlueCard),onClickConfig:()=>{const e=prompt("Blue Card Number:",t.blueCardNumber||""),s=prompt("Blue Card Expiry (YYYY-MM-DD):",t.blueCardExpiry||"");a({blueCardNumber:e||null,blueCardExpiry:s||null})}}),e.jsx(y,{icon:e.jsx(d,{className:"h-3 w-3"}),label:"Ministry Training",needed:!!(null==l?void 0:l.requiresMinistryTraining),ok:!!(null==l?void 0:l.ministryTrainingCompleted),onClickConfig:()=>{confirm("Mark training as completed manually? This is an override.")&&a({trainingCompletedManual:!0})}}),e.jsx(y,{icon:e.jsx(c,{className:"h-3 w-3"}),label:"Docs",needed:!0,ok:!!(null==l?void 0:l.documentsComplete),onClickConfig:()=>{const e=confirm("Toggle Policy Acknowledged?"),s=confirm("Toggle Background Check Completed?"),l=confirm("Toggle Police Check Completed?");a({policyAcknowledged:e?!t.policyAcknowledged:t.policyAcknowledged,backgroundCheckCompleted:s?!t.backgroundCheckCompleted:t.backgroundCheckCompleted,policeCheckCompleted:l?!t.policeCheckCompleted:t.policeCheckCompleted})}})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-[11px] md:text-xs text-gray-400",children:"Driver’s License (front):"}),e.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:e=>{var a;return(null==(a=e.target.files)?void 0:a[0])&&s(t.id,e.target.files[0])},className:"text-[11px] md:text-xs text-gray-300"}),t.driversLicenseFrontUrl&&e.jsx("span",{className:"text-[11px] md:text-xs text-green-400",children:"Uploaded"})]}),e.jsx("div",{className:"text-[11px] md:text-xs",children:(null==l?void 0:l.eligible)?e.jsxs("span",{className:"inline-flex items-center gap-1 bg-green-500/20 text-green-400 px-2 py-0.5 font-semibold",children:[e.jsx(o,{className:"h-3 w-3"})," Eligible"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 bg-yellow-500/20 text-yellow-400 px-2 py-0.5 font-semibold",children:[e.jsx(n,{className:"h-3 w-3"})," Incomplete"]})})]})}function y({icon:t,label:a,needed:s,ok:l,onClickConfig:i}){return e.jsxs("button",{onClick:i,className:"inline-flex items-center gap-1 px-2 py-1 text-[11px] md:text-xs border "+(s?l?"bg-green-500/20 text-green-400 border-green-500/30":"bg-red-500/20 text-red-400 border-red-500/30":"bg-gray-700 text-gray-300 border-gray-600"),title:"Click to configure/update",children:[t,e.jsxs("span",{children:[a,s?"":" (N/A)"]})]})}export{m as default};
