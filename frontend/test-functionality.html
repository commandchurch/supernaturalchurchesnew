<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Command Church - End-to-End Testing</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-item {
            margin: 10px 0;
            padding: 10px;
            background: #f9f9f9;
            border-left: 4px solid #ddd;
        }
        .pass { border-left-color: #4CAF50; background: #f0f8f0; }
        .fail { border-left-color: #f44336; background: #fdf0f0; }
        .warning { border-left-color: #ff9800; background: #fff8f0; }
        .test-btn {
            background: #007cba;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
        }
        .test-btn:hover { background: #005a87; }
        .status { font-weight: bold; }
        .url-input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .results {
            margin-top: 20px;
            padding: 15px;
            background: #f5f5f5;
            border-radius: 5px;
            white-space: pre-wrap;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª Command Church - End-to-End Testing Suite</h1>
        
        <div class="test-section">
            <h2>ğŸŒ Test Environment Configuration</h2>
            <label for="baseUrl">Base URL to Test:</label>
            <input type="text" id="baseUrl" class="url-input" 
                   value="https://frontend-seven-kappa-37-a8qot9uum-commandchurchs-projects.vercel.app" 
                   placeholder="Enter the production URL">
            <button class="test-btn" onclick="setBaseUrl()">Set URL</button>
            
            <div class="test-item">
                <strong>Current Test URL:</strong> <span id="currentUrl">Not set</span>
            </div>
        </div>

        <div class="test-section">
            <h2>ğŸ  1. Home Page Testing</h2>
            <button class="test-btn" onclick="testHomePage()">Test Home Page</button>
            <div id="homePageResults" class="results" style="display:none;"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ’³ 2. Membership & Payment Testing</h2>
            <button class="test-btn" onclick="testMembershipPage()">Test Membership Page</button>
            <button class="test-btn" onclick="testJoinNowButtons()">Test JOIN NOW Buttons</button>
            <div id="membershipResults" class="results" style="display:none;"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ” 3. Authentication Testing</h2>
            <button class="test-btn" onclick="testAuthenticationFlow()">Test Login/Logout</button>
            <div id="authResults" class="results" style="display:none;"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ“Š 4. Dashboard Access Testing</h2>
            <button class="test-btn" onclick="testDashboardAccess()">Test Dashboard</button>
            <div id="dashboardResults" class="results" style="display:none;"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ‘‘ 5. Admin Access Testing</h2>
            <button class="test-btn" onclick="testAdminAccess()">Test Admin Access</button>
            <div class="test-item">
                <strong>Admin Emails to Test:</strong>
                <ul>
                    <li>commandchurch@gmail.com</li>
                    <li>supernaturalchurches.australia@gmail.com</li>
                    <li>supernaturalinstitute.australia@gmail.com</li>
                </ul>
            </div>
            <div id="adminResults" class="results" style="display:none;"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ™ 6. Prayer Request Testing</h2>
            <button class="test-btn" onclick="testPrayerRequests()">Test Prayer Submission</button>
            <div id="prayerResults" class="results" style="display:none;"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ“ 7. Academy Course Testing</h2>
            <button class="test-btn" onclick="testAcademyCourses()">Test Academy Access</button>
            <div id="academyResults" class="results" style="display:none;"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ§­ 8. Navigation Testing</h2>
            <button class="test-btn" onclick="testNavigation()">Test All Links</button>
            <div id="navigationResults" class="results" style="display:none;"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ“± 9. Mobile Responsive Testing</h2>
            <button class="test-btn" onclick="testMobileResponsive()">Test Mobile Design</button>
            <div id="mobileResults" class="results" style="display:none;"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ› 10. Console Error Testing</h2>
            <button class="test-btn" onclick="testConsoleErrors()">Check Console Errors</button>
            <div id="consoleResults" class="results" style="display:none;"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ“‹ Test Summary</h2>
            <div id="testSummary" class="results">
                Click "Run All Tests" to start comprehensive testing...
            </div>
            <button class="test-btn" onclick="runAllTests()" style="background: #4CAF50; font-size: 16px; padding: 15px 30px;">
                ğŸš€ Run All Tests
            </button>
        </div>
    </div>

    <script>
        let baseUrl = '';
        const results = {};

        function setBaseUrl() {
            baseUrl = document.getElementById('baseUrl').value.trim();
            if (!baseUrl.startsWith('http')) {
                baseUrl = 'https://' + baseUrl;
            }
            document.getElementById('currentUrl').textContent = baseUrl;
            logResult('Config', 'âœ… Base URL set to: ' + baseUrl);
        }

        function logResult(test, message) {
            results[test] = results[test] || [];
            results[test].push(new Date().toLocaleTimeString() + ' - ' + message);
            updateTestSummary();
        }

        function showResults(elementId, testName) {
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            element.textContent = results[testName]?.join('\\n') || 'No results yet';
        }

        function testHomePage() {
            logResult('HomePage', 'ğŸ  Testing home page...');
            
            if (!baseUrl) {
                logResult('HomePage', 'âŒ Base URL not set');
                showResults('homePageResults', 'HomePage');
                return;
            }

            // Test if URL is accessible
            fetch(baseUrl)
                .then(response => {
                    if (response.ok) {
                        logResult('HomePage', 'âœ… Home page loads successfully (Status: ' + response.status + ')');
                        logResult('HomePage', 'âœ… Response headers: ' + JSON.stringify(Object.fromEntries(response.headers)));
                    } else {
                        logResult('HomePage', 'âŒ Home page failed to load (Status: ' + response.status + ')');
                    }
                })
                .catch(error => {
                    logResult('HomePage', 'âŒ Network error: ' + error.message);
                })
                .finally(() => {
                    showResults('homePageResults', 'HomePage');
                });
        }

        function testMembershipPage() {
            logResult('Membership', 'ğŸ’³ Testing membership page...');
            
            const membershipUrl = baseUrl + '/membership';
            
            fetch(membershipUrl)
                .then(response => {
                    if (response.ok) {
                        logResult('Membership', 'âœ… Membership page loads successfully');
                        return response.text();
                    } else {
                        throw new Error('HTTP ' + response.status);
                    }
                })
                .then(html => {
                    // Check for JOIN NOW buttons
                    if (html.includes('Join Now') || html.includes('JOIN NOW')) {
                        logResult('Membership', 'âœ… JOIN NOW buttons found in page');
                    } else {
                        logResult('Membership', 'âš ï¸ JOIN NOW buttons not found in HTML');
                    }
                    
                    // Check for subscription tiers
                    if (html.includes('BRONZE') || html.includes('SILVER') || html.includes('GOLD')) {
                        logResult('Membership', 'âœ… Subscription tiers found');
                    } else {
                        logResult('Membership', 'âš ï¸ Subscription tiers not found');
                    }
                })
                .catch(error => {
                    logResult('Membership', 'âŒ Error: ' + error.message);
                })
                .finally(() => {
                    showResults('membershipResults', 'Membership');
                });
        }

        function testJoinNowButtons() {
            logResult('Membership', 'ğŸ”˜ Testing JOIN NOW button functionality...');
            logResult('Membership', 'âš ï¸ Manual test required: Click JOIN NOW buttons to test Stripe integration');
            logResult('Membership', 'ğŸ“ Expected: Should redirect to Stripe checkout with AUD pricing');
            showResults('membershipResults', 'Membership');
        }

        function testAuthenticationFlow() {
            logResult('Auth', 'ğŸ” Testing authentication...');
            logResult('Auth', 'âš ï¸ Manual test required: Test login/logout with Clerk');
            logResult('Auth', 'ğŸ“ Expected: Clerk modal should appear for authentication');
            logResult('Auth', 'ğŸ“ Test emails: commandchurch@gmail.com, etc.');
            showResults('authResults', 'Auth');
        }

        function testDashboardAccess() {
            logResult('Dashboard', 'ğŸ“Š Testing dashboard access...');
            
            const dashboardUrl = baseUrl + '/dashboard';
            
            fetch(dashboardUrl)
                .then(response => {
                    if (response.ok) {
                        logResult('Dashboard', 'âœ… Dashboard page loads');
                        return response.text();
                    } else {
                        throw new Error('HTTP ' + response.status);
                    }
                })
                .then(html => {
                    if (html.includes('dashboard') || html.includes('Dashboard')) {
                        logResult('Dashboard', 'âœ… Dashboard content found');
                    }
                    logResult('Dashboard', 'âš ï¸ Authentication required - need manual login test');
                })
                .catch(error => {
                    logResult('Dashboard', 'âŒ Error: ' + error.message);
                })
                .finally(() => {
                    showResults('dashboardResults', 'Dashboard');
                });
        }

        function testAdminAccess() {
            logResult('Admin', 'ğŸ‘‘ Testing admin access...');
            
            const adminUrl = baseUrl + '/admin';
            
            fetch(adminUrl)
                .then(response => {
                    if (response.ok) {
                        logResult('Admin', 'âœ… Admin page loads');
                        logResult('Admin', 'âš ï¸ Manual test required: Login with admin emails');
                        logResult('Admin', 'ğŸ“ Admin emails: commandchurch@gmail.com');
                        logResult('Admin', 'ğŸ“ Admin emails: supernaturalchurches.australia@gmail.com');
                        logResult('Admin', 'ğŸ“ Admin emails: supernaturalinstitute.australia@gmail.com');
                    } else {
                        throw new Error('HTTP ' + response.status);
                    }
                })
                .catch(error => {
                    logResult('Admin', 'âŒ Error: ' + error.message);
                })
                .finally(() => {
                    showResults('adminResults', 'Admin');
                });
        }

        function testPrayerRequests() {
            logResult('Prayer', 'ğŸ™ Testing prayer requests...');
            logResult('Prayer', 'âš ï¸ Manual test required: Submit prayer request form');
            logResult('Prayer', 'ğŸ“ Expected: Form should submit to Convex backend');
            logResult('Prayer', 'ğŸ“ Check: No localhost:4000 errors in console');
            showResults('prayerResults', 'Prayer');
        }

        function testAcademyCourses() {
            logResult('Academy', 'ğŸ“ Testing academy courses...');
            
            const academyUrl = baseUrl + '/academy';
            
            fetch(academyUrl)
                .then(response => {
                    if (response.ok) {
                        logResult('Academy', 'âœ… Academy page loads');
                        return response.text();
                    } else {
                        throw new Error('HTTP ' + response.status);
                    }
                })
                .then(html => {
                    if (html.includes('course') || html.includes('Course')) {
                        logResult('Academy', 'âœ… Course content found');
                    }
                    logResult('Academy', 'âš ï¸ Manual test: Browse courses and test enrollment');
                })
                .catch(error => {
                    logResult('Academy', 'âŒ Error: ' + error.message);
                })
                .finally(() => {
                    showResults('academyResults', 'Academy');
                });
        }

        function testNavigation() {
            logResult('Navigation', 'ğŸ§­ Testing navigation links...');
            
            const testUrls = [
                '/about',
                '/membership', 
                '/academy',
                '/give',
                '/events',
                '/connect',
                '/church',
                '/legal'
            ];

            let completed = 0;
            
            testUrls.forEach(path => {
                fetch(baseUrl + path)
                    .then(response => {
                        if (response.ok) {
                            logResult('Navigation', 'âœ… ' + path + ' loads successfully');
                        } else {
                            logResult('Navigation', 'âŒ ' + path + ' failed (Status: ' + response.status + ')');
                        }
                    })
                    .catch(error => {
                        logResult('Navigation', 'âŒ ' + path + ' error: ' + error.message);
                    })
                    .finally(() => {
                        completed++;
                        if (completed === testUrls.length) {
                            showResults('navigationResults', 'Navigation');
                        }
                    });
            });
        }

        function testMobileResponsive() {
            logResult('Mobile', 'ğŸ“± Testing mobile responsiveness...');
            logResult('Mobile', 'âš ï¸ Manual test required: Check responsive design');
            logResult('Mobile', 'ğŸ“ Test: Resize browser window to mobile sizes');
            logResult('Mobile', 'ğŸ“ Test: Check menu hamburger, touch interactions');
            logResult('Mobile', 'ğŸ“ Test: Verify readability on mobile screens');
            showResults('mobileResults', 'Mobile');
        }

        function testConsoleErrors() {
            logResult('Console', 'ğŸ› Checking console errors...');
            
            // Check for console errors
            const consoleErrors = [];
            const originalError = console.error;
            
            console.error = function(...args) {
                consoleErrors.push('Error: ' + args.join(' '));
                originalError.apply(console, args);
            };
            
            // Check for localhost:4000 errors specifically
            logResult('Console', 'ğŸ” Checking for localhost:4000 errors...');
            logResult('Console', 'âš ï¸ Manual check: Open browser DevTools and look for:');
            logResult('Console', '   - Network errors to localhost:4000');
            logResult('Console', '   - Failed to fetch errors');
            logResult('Console', '   - CORS errors');
            logResult('Console', '   - Uncaught TypeError errors');
            
            if (consoleErrors.length > 0) {
                logResult('Console', 'âŒ Console errors detected: ' + consoleErrors.join(', '));
            } else {
                logResult('Console', 'âœ… No console errors captured during this test');
            }
            
            showResults('consoleResults', 'Console');
        }

        function runAllTests() {
            logResult('Summary', 'ğŸš€ Starting comprehensive test suite...');
            
            if (!baseUrl) {
                alert('Please set the base URL first!');
                return;
            }
            
            // Run all tests in sequence
            testHomePage();
            setTimeout(() => testMembershipPage(), 500);
            setTimeout(() => testDashboardAccess(), 1000);
            setTimeout(() => testAdminAccess(), 1500);
            setTimeout(() => testAcademyCourses(), 2000);
            setTimeout(() => testNavigation(), 2500);
            setTimeout(() => testConsoleErrors(), 3000);
            
            // Manual tests
            setTimeout(() => {
                logResult('Summary', 'ğŸ” Manual tests required:');
                logResult('Summary', '   1. JOIN NOW buttons â†’ Stripe checkout');
                logResult('Summary', '   2. Login/logout with Clerk');
                logResult('Summary', '   3. Admin access with specified emails');
                logResult('Summary', '   4. Prayer request submission');
                logResult('Summary', '   5. Mobile responsive design');
                logResult('Summary', '   6. Console error checking');
                logResult('Summary', 'âœ… Automated tests completed!');
                showResults('', 'Summary');
            }, 4000);
        }

        function updateTestSummary() {
            const summary = document.getElementById('testSummary');
            let output = '';
            
            for (const [test, messages] of Object.entries(results)) {
                output += `\\n=== ${test} ===\\n`;
                output += messages.join('\\n') + '\\n';
            }
            
            summary.textContent = output || 'No tests run yet...';
        }

        // Initialize
        setBaseUrl();
    </script>
</body>
</html>
